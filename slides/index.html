<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PowerPoint Clone</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        #ribbon {
            height: 50px;
            background: #ddd;
            display: flex;
            align-items: center;
            padding: 0 10px;
            box-sizing: border-box;
        }
        #tabs {
            display: flex;
        }
        .tab {
            padding: 10px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
        }
        .tab.active {
            border-bottom: 3px solid blue;
        }
        .tab-content {
            display: none;
            padding: 10px;
            background: #eee;
        }
        .tab-content.active {
            display: flex;
        }
        #sidebar {
            width: 200px;
            background: #F0F0F0;
            padding: 10px;
            overflow-y: auto;
        }
        .slide-thumbnail {
            padding: 10px;
            border: 1px solid #ccc;
            margin-bottom: 10px;
            cursor: pointer;
            background: white;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100px;
        }
        .selected {
            background: #b0c4de;
        }
        #slide-container {
            flex-grow: 1;
            background: white;
            display: flex;
            justify-content: center;
            align-items: center;
            border-left: 2px solid #ccc;
            padding-top: 50px;
        }
        #slide {
            width: 80%;
            height: 80%;
            border: 1px solid black;
            padding: 10px;
            overflow: auto;
        }
    </style>
</head>
<body>
    <div id="ribbon">
        <div id="tabs">
            <div class="tab active" onclick="switchTab(event, 'home')">Home</div>
            <div class="tab" onclick="switchTab(event, 'design')">Design</div>
            <div class="tab" onclick="switchTab(event, 'transitions')">Transitions</div>
            <div class="tab" onclick="switchTab(event, 'file')">File</div>
        </div>
    </div>
    <div id="tab-contents">
        <div class="tab-content active" id="home">
            <button onclick="addSlide()">Add Slide</button>
            <select id="fontSelect" onchange="changeFont(this.value)">
                <option value="Arial">Arial</option>
                <option value="Verdana">Verdana</option>
                <option value="Times New Roman">Times New Roman</option>
                <option value="Courier New">Courier New</option>
            </select>
        </div>
        <div class="tab-content" id="design">
            <button onclick="setTheme('light')">Light Theme</button>
            <button onclick="setTheme('dark')">Dark Theme</button>
        </div>
        <div class="tab-content" id="transitions">
            <button onclick="setTransition('fade')">Fade</button>
            <button onclick="setTransition('slide')">Slide In</button>
        </div>
        <div class="tab-content" id="file">
            <button onclick="openPresentation()">Open</button>
            <button onclick="savePresentation()">Save</button>
        </div>
    </div>
    <div style="display: flex; height: 100%;">
        <div id="sidebar"></div>
        <div id="slide-container">
            <div id="slide" contenteditable="true"></div>
        </div>
    </div>
    <script>
        let slides = [""];
        let currentSlide = 0;

        function switchTab(event, tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        function renderThumbnails() {
            const sidebar = document.getElementById('sidebar');
            sidebar.innerHTML = '';
            slides.forEach((content, index) => {
                const thumbnail = document.createElement('div');
                thumbnail.className = 'slide-thumbnail' + (index === currentSlide ? ' selected' : '');
                thumbnail.innerHTML = content;
                thumbnail.onclick = () => switchSlide(index);
                sidebar.appendChild(thumbnail);
            });
        }

        function addSlide() {
            slides[currentSlide] = document.getElementById('slide').innerHTML;
            slides.push("");
            currentSlide = slides.length - 1;
            updateSlide();
            renderThumbnails();
        }

        function switchSlide(index) {
            slides[currentSlide] = document.getElementById('slide').innerHTML;
            currentSlide = index;
            updateSlide();
            renderThumbnails();
        }

        function updateSlide() {
            document.getElementById('slide').innerHTML = slides[currentSlide];
        }

        function changeFont(font) {
            document.getElementById('slide').style.fontFamily = font;
        }

        function setTheme(theme) {
            document.getElementById('slide').style.background = theme === 'dark' ? '#333' : 'white';
            document.getElementById('slide').style.color = theme === 'dark' ? 'white' : 'black';
        }

        function setTransition(type) {
            document.getElementById('slide').style.transition = type === 'fade' ? 'opacity 1s' : 'transform 1s';
        }

        function savePresentation() {
            const blob = new Blob([JSON.stringify(slides)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'presentation.SLIDE2';
            a.click();
            URL.revokeObjectURL(url);
        }

        function openPresentation() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.SLIDE2';
            input.onchange = event => {
                const file = event.target.files[0];
                const reader = new FileReader();
                reader.onload = e => {
                    slides = JSON.parse(e.target.result);
                    currentSlide = 0;
                    updateSlide();
                    renderThumbnails();
                };
                reader.readAsText(file);
            };
            input.click();
        }

        renderThumbnails();
        updateSlide();
    </script>
</body>
</html>
